<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">











<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <title>HTTP Builder - XML</title>
    <style type="text/css" media="all">
      @import url("../css/maven-base.css");
      @import url("../css/maven-theme.css");
      @import url("../css/site.css");
    </style>
    <link rel="stylesheet" href="../css/print.css" type="text/css" media="print" />
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
                                                    
<link rel="stylesheet" type="text/css" href="http://alexgorbatchev.com/pub/sh/current/styles/shCore.css" media="all"/>
                                                        
<link rel="stylesheet" type="text/css" href="http://alexgorbatchev.com/pub/sh/current/styles/shThemeFadeToGrey.css" media="all"/>
                                                        
<style>#bodyColumn { max-width: 840px }</style>
                                                        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shCore.js" language="javaScript"></script>
                                                        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushGroovy.js" language="javaScript"></script>
                                                        
<script src="http://alexgorbatchev.com/pub/sh/current/scripts/shBrushXml.js" language="javaScript"></script>
                                                        
<script language="javascript">SyntaxHighlighter.defaults['light'] = true;
			 SyntaxHighlighter.all();</script>
                    </head>
  <body class="composite">
    <div id="banner">
                  <a href="index.html" id="bannerLeft">
    
                                            <img src="../images/logo.png" alt="" />
    
            </a>
                        <a href="../../" id="bannerRight">
    
                                    <img src="http://media.xircles.codehaus.org/_projects/groovy/_logos/medium.png" alt="" />
    
            </a>
            <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
          
  

  
    
            
  
    
            <div class="xleft">
        Version: 0.5.0-RC3
              </div>
            <div class="xright">      
  

  
    
            
  
    
             Last Published: 2010-02-17
            </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
           
  

  
    
            
  
    
                   <h5>Overview</h5>
            <ul>
              
    <li class="none">
                    <a href="../home.html">Home</a>
          </li>
              
    <li class="none">
                    <a href="../index.html">News</a>
          </li>
              
    <li class="none">
                    <a href="../download.html">Download</a>
          </li>
              
                
              
      
            
      
            
      
            
            
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
            <li class="expanded">
                    <a href="../doc/index.html">Documentation</a>
                  <ul>
                  
    <li class="none">
                    <a href="../doc/get.html">GET Examples</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/post.html">POST Examples</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/json.html">Using JSON</a>
          </li>
                  
    <li class="none">
              <strong>Using XML</strong>
        </li>
                  
    <li class="none">
                    <a href="../doc/rest.html">RESTClient</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/async.html">AsyncHTTPBuilder</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/httpurlclient.html">HttpURLClient</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/contentTypes.html">Content Types</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/handlers.html">Response Handlers</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/uribuilder.html">URIBuilder</a>
          </li>
                  
    <li class="none">
                    <a href="../doc/ssl.html">SSL</a>
          </li>
              </ul>
        </li>
              
    <li class="none">
                    <a href="../apidocs/index.html">JavaDoc</a>
          </li>
              
    <li class="none">
                    <a href="../changes.html">Changelog</a>
          </li>
              
    <li class="none">
                    <a href="http://twitter.com/httpbuilder" class="externalLink">On Twitter!</a>
          </li>
              
    <li class="none">
                    <a href="https://www.ohloh.net/p/http-builder" class="externalLink">On Ohloh</a>
          </li>
              
    <li class="none">
                    <a href="../home.html#Support">Support</a>
          </li>
              
    <li class="none">
                    <a href="../about.html">About</a>
          </li>
          </ul>
              <h5>Additional Reference</h5>
            <ul>
              
    <li class="none">
                    <a href="../../../Documentation">Groovy</a>
          </li>
              
    <li class="none">
                    <a href="http://hc.apache.org/httpcomponents-client/" class="externalLink">HttpClient</a>
          </li>
              
    <li class="none">
                    <a href="http://hc.apache.org/httpcomponents-core/" class="externalLink">HttpCore</a>
          </li>
              
    <li class="none">
                    <a href="http://json-lib.sourceforge.net/" class="externalLink">JSON-Lib</a>
          </li>
              
    <li class="none">
                    <a href="http://nekohtml.sourceforge.net/" class="externalLink">NekoHTML</a>
          </li>
          </ul>
              <h5>Project Documentation</h5>
            <ul>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../project-info.html">Project Information</a>
                </li>
              
                
              
      
            
      
            
      
            
      
            
      
            
      
              
        <li class="collapsed">
                    <a href="../project-reports.html">Project Reports</a>
                </li>
          </ul>
                                                 
                        
                        
            <a href="http://maven.apache.org/" title="Maven" class="poweredBy">
                            <img alt="Maven" src="http://maven.apache.org/images/logos/maven-feather.png" />
            </a>
                                
                        
                        
            <a href="http://www.ohloh.net/p/http-builder" title="Ohloh" class="poweredBy">
                            <img alt="Ohloh" src="http://www.ohloh.net/p/http-builder/widgets/project_thin_badge.gif" />
            </a>
                               
  

  
    
            
  
    
        </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <div class="section"><h2>Parsing XML data</h2>
<p>By default, HTTPBuilder classes will automatically parse XML responses using an <tt><a href="http://groovy.codehaus.org/gapi/groovy/util/XmlSlurper.html" class="externalLink">XmlSlurper</a></tt>.</p>
<p>You can try the following example in the Groovy console (Groovy 1.6+ is needed for the <tt>@Grab</tt> macro):</p>
<pre class="brush: groovy">import groovyx.net.http.*
@Grab(group='org.codehaus.groovy.modules.http-builder', 
    module='http-builder', version='0.5.0-RC2' )
def grabMethod() {} // for Grab annotation

def http = new HTTPBuilder( 'http://twitter.com/statuses/' )

http.get( path: 'user_timeline.xml', query:[id:'httpbuilder'] ) { resp, xml -&gt;
    println resp.status
    xml.status.each {  // iterate over each XML 'status' element in the response:
        println it.created_at.text()
        println &quot;  &quot; + it.text.text()
    }
}
</pre><p>HTTPBuilder will automatically detect the content-type (assuming the sends the correct response header) and parse the response as XML. It is not necessary (but optional) to explicitly specify the <tt>contentType: ContentType.XML</tt> parameter.</p>
<p><b>HTML</b> response data will also be parsed automatically, by using <a href="http://nekohtml.sourceforge.net/" class="externalLink">NekoHTML</a> which corrects the XML stream before it is passed to the <tt>XmlSlurper</tt>. The resulting behavior is that you can parse HTML as if it was well-formed XML.</p>
<div class="section"><h3>DTDs, Schemas and Entities</h3>
<p>Keep in mind that particularly when parsing HTML documents, they often refer to external DTDs. The required behavior of all JAXP XML parsers is to retrieve and parse any referenced entities (e.g. DTD, schema, etc.) <i>every time</i> the document is processed (yes, even if validation is disabled.) This can become costly when the referenced entity document never changes. </p>
<p>To avoid the overhead of downloading and parsing externally referenced documents for every request, the HTTPBuilder's built-in XML and HTML parser uses an <a href="http://xml.apache.org/commons/components/resolver/resolver-article.html" class="externalLink">XML Catalog</a> to store a local copy of frequently used DTD and entity definitions. You can <a href="../apidocs/groovyx/net/http/ParserRegistry.html#addCatalog(java.net.URL)">add additional entity files</a> to the default parser's catalog as well. </p>
</div>
</div>
<div class="section"><h2>POSTing XML data</h2>
<p>XML data is serialized using <tt><a href="http://groovy.codehaus.org/gapi/index.html?groovy/xml/StreamingMarkupBuilder.html" class="externalLink">StreamingMarkupBuilder</a></tt>. You can define the <tt>body</tt> property as a closure like so:</p>
<pre class="brush: groovy">http.request( POST, XML ) {
  
  body = {
    auth {
      user 'Bob'
      password 'pass'
    }
  }
}
</pre><p>The body is then transformed to an XML string by <tt><a href="../apidocs/groovyx/net/http/EncoderRegistry.html#encodeXML(groovy.lang.Closure)">EncoderRegistry.encodeXML()</a></tt>. Alternatively, the XML body may be passed as a raw string as well.</p>
</div>
<div class="section"><h2>Reading an XML response as plain text</h2>
<p>Another common request is <i>&quot;What if I want to display the raw XML rather than parse it?&quot;</i></p>
<p>In order to do that, you're going to send a <tt>contentType</tt> parameter, to force HTTPBuilder (or RESTClient) to use the <tt>TEXT</tt> parser. However, since setting the <tt>contentType</tt> also affects the <tt>Accept</tt> request header, we might need to override that as well.</p>
<p>For Example: </p>
<pre class="brush: groovy">import groovyx.net.http.*
import static groovyx.net.http.ContentType.*

def twitter = new RESTClient( 'https://twitter.com/statuses/' )
// ... auth &amp; setup configuration omitted here ...

def resp = twitter.get( path : 'friends_timeline.xml', contentType : TEXT,
                        headers : [Accept : 'application/xml'] )

println resp.data.text       // print the XML
</pre><p>Furthermore, you can use HTTPBuilder's defaults to reduce the number of parameters passed to each request method like so:</p>
<pre class="brush: groovy">def twitter = new RESTClient( 'https://twitter.com/statuses/' )

// set a default response content-type
twitter.contentType = TEXT
/* set default headers which will override what's automatically sent in the
   request by the default contentType param */  
twitter.headers = [ Accept : 'application/xml', ]

def resp = twitter.get( path : 'friends_timeline.xml' )
</pre></div>

      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">&#169;  
          2008-2010
    
          
  

  
    
            
  
    
  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
